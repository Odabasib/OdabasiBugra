SET QUOTED_IDENTIFIER, ANSI_NULLS OFF
GO
Create View [GUSTO00001].[V_GenelVirman]  (pIslemID,sTur,sKod,sAd,sAciklama,cBorcAlacak,ldTutar,pHareket) As  (SELECT pIslemID, 'Banka' sTur, sKod,  sAd,  sAciklama,  cBorcAlacak,  ldTutar, BankaHareket_rowid pHareket FROM GUSTO00001.BankaHareket INNER JOIN GUSTO00001.BankaKodu ON  pBanka = BankaKodu_rowid WHERE nHareketTuru=32) UNION (SELECT pIslemID, 'Kasa' sTur, sKod,  sAd,  sAciklama,  cBorcAlacak, ldTutar, KasaHareket_rowid pHareket FROM GUSTO00001.KasaHareket INNER JOIN GUSTO00001.KasaKodu ON  pKasa = KasaKodu_rowid WHERE nHareketTuru=32) UNION (SELECT pIslemID, 'Cari' sTur, sKod,  sAd,  sAciklama,  cBorcAlacak,  ldTutar, CariHareket_rowid pHareket FROM GUSTO00001.CariHareket INNER JOIN GUSTO00001.MusteriSaticiKodu ON  pCariKodID = MusteriSaticiKodu_rowid WHERE nHareketTuru=32) UNION (SELECT pIslemID, 'Di?er' sTur, sKod,  sAd,  sAciklama,  cBorcAlacak,  ldTutar, DigerHareket_rowid pHareket FROM GUSTO00001.DigerHareket INNER JOIN GUSTO00001.MSDigerKodu ON  pDigerKodID = MSDigerKodu_rowid WHERE nHareketTuru=32) UNION (SELECT pIslemID, 'Personel' sTur, sKod,  sAd + sSoyad sAd,  sAciklama,  cBorcAlacak, ldTutar, PersonelHareket_rowid pHareket FROM GUSTO00001.PersonelHareket INNER JOIN GUSTO00001.PersonelKodu ON pPersonel = PersonelKodu_rowid WHERE nHareketTuru=32) UNION (SELECT pIslemID, 'Hizmet' sTur, sKod,  sAd,  sAciklama,  (case cGirisCikis when '0' then 'B' else 'A' end) cBorcAlacak,  ldFAIskontoSonrasiTutar ldTutar, StokHareket_rowid pHareket FROM GUSTO00001.StokHareket INNER JOIN GUSTO00001.HizmetKodu ON  pStokKodu = HizmetKodu_rowid WHERE cStokHizmetDemirbas='H' and pIslemID!=0)
GO